(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=r(a);fetch(a.href,n)}})();const q=await fetch("src/ui/header/template.html"),z=await q.text();let D={};D.render=function(){return z};const x={chart:null,option:null,init:function(){const t=document.getElementById("main");this.chart=echarts.init(t,null,{renderer:"canvas",useDirtyRect:!1}),this.option={title:{text:"Livraison des commandes",top:"0%"},tooltip:{trigger:"item"},legend:{top:"15%",left:"center"},series:[{name:"Statut des commandes",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},top:"25%",bottom:"0%",emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},labelLine:{show:!1},data:[{value:1048,name:"Moteur de Recherche"},{value:735,name:"Direct"},{value:580,name:"Email"},{value:484,name:"Publicités de Groupe"},{value:300,name:"Publicités Vidéo"}]}]},this.chart.setOption(this.option),window.addEventListener("resize",()=>{this.chart.resize()})},updateData:function(t){if(!this.option.series||!this.option.series[0]){console.error("Erreur : 'series' n'est pas correctement définie dans l'option.");return}this.option.series[0].data=t,this.chart.setOption(this.option)}},b={chart:null,option:null,init:function(){const t=document.getElementById("graphic-barre");this.chart=echarts.init(t,null,{renderer:"canvas",useDirtyRect:!1}),this.option={title:{text:"Meilleures ventes des deux dernièrs mois"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value"}],series:[{name:"Ventes",type:"bar",barWidth:"60%",data:[10,52,200,334,390,330,220]}]},this.option&&typeof this.option=="object"&&this.chart.setOption(this.option),window.addEventListener("resize",()=>{this.chart.resize()})},updateData:function(t,e){if(!this.option){console.error("Erreur : 'option' n'est pas encore initialisé.");return}if(!this.option.series||!this.option.series[0]){console.error("Erreur : 'series' n'est pas correctement définie dans l'option.");return}this.option.series[0].data=t,e&&(this.option.xAxis[0].data=e),this.chart.setOption(this.option,!0),this.chart.resize()}},v={chart:null,option:null,init:function(){const t=document.getElementById("graphic-courbe");this.chart=echarts.init(t,null,{renderer:"canvas",useDirtyRect:!1}),this.option={title:{text:"Revenus totaux des six derniers mois"},tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0}}},xAxis:{type:"category",boundaryGap:!1,data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{name:"Revenus totaux",data:[820,932,901,934,1290,1330,1320],type:"line",areaStyle:{}}]},this.option&&typeof this.option=="object"&&this.chart.setOption(this.option),window.addEventListener("resize",()=>{this.chart.resize()})},updateData:function(t,e){if(!this.option){console.error("Erreur : 'option' n'est pas encore initialisé.");return}if(!this.option.series||!this.option.series[0]){console.error("Erreur : 'series' n'est pas correctement définie dans l'option.");return}this.option.series[0].data=t,e&&(this.option.xAxis.data=e),this.chart.setOption(this.option,!0),this.chart.resize()}},I={chart:null,option:null,init:function(){const t=document.getElementById("graphic-barrecourbe");this.chart=echarts.init(t,null,{renderer:"canvas",useDirtyRect:!1}),this.option={title:{text:"Revenus totaux par Categorie",top:"0%"},tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:["Evaporation","Precipitation","Temperature"],top:"10%"},xAxis:[{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"Montant",axisLabel:{formatter:"{value} $"}}],series:[{name:"Montant",type:"bar",top:"20%",bottom:"0%",tooltip:{valueFormatter:function(e){return e+" $"}},data:[2,4.9,7,23.2,25.6,76.7,135.6,162.2,32.6,20,6.4,3.3]}]},this.option&&typeof this.option=="object"&&this.chart.setOption(this.option),window.addEventListener("resize",()=>{this.chart.resize()})},updateData:function(t,e,r){if(!this.option){console.error("Erreur : 'option' n'est pas encore initialisé.");return}if(!this.option.series){console.error("Erreur : 'series' n'est pas correctement définie dans l'option.");return}this.option.series=t.map((i,a)=>({name:r[a],type:"bar",tooltip:{valueFormatter:function(n){return n+" $"}},data:i})),e&&(this.option.xAxis[0].data=e),r&&(this.option.legend.data=r),this.chart.setOption(this.option,!0),this.chart.resize()}},E={chart:null,option:null,init:function(){const t=document.getElementById("graphic-demicercle");this.chart=echarts.init(t,null,{renderer:"canvas",useDirtyRect:!1}),this.option={title:{text:"Produits en baisse de stock"},tooltip:{trigger:"item"},series:[{name:"Stock Faible",type:"pie",radius:["40%","70%"],center:["50%","70%"],startAngle:180,endAngle:360,data:[{value:0,name:"Search Engine"},{value:1,name:"Direct"},{value:1,name:"Email"},{value:1,name:"Union Ads"},{value:2,name:"Video "},{value:4,name:" Ads"},{value:6,name:"VideoAds"},{value:8,name:"Video ds"},{value:10,name:"Video As"},{value:11,name:"Vide Ads"}]}]},this.option&&typeof this.option=="object"&&this.chart.setOption(this.option),window.addEventListener("resize",()=>{this.chart.resize()})},updateData:function(t){if(!this.option){console.error("Erreur : 'option' n'est pas encore initialisé.");return}if(!this.option.series||!this.option.series[0]){console.error("Erreur : 'series' n'est pas correctement définie dans l'option.");return}this.option.series[0].data=t,this.chart.setOption(this.option,!0),this.chart.resize()}},g={chart:null,option:null,init:function(){const t=document.getElementById("graphic-client");this.chart=echarts.init(t,null,{renderer:"canvas",useDirtyRect:!1});const e={charts:{map:3237,lines:2164,bar:7561,line:7778,pie:7355,scatter:2405,candlestick:1842,radar:2090,heatmap:1762,treemap:1593,graph:2060,boxplot:1537,parallel:1908,gauge:2107,funnel:1692,sankey:1568}},r={"echarts.min":17365,"echarts.simple.min":4079,"echarts.common.min":6929,echarts:14890},i=document.createElement("canvas");i.width=i.height=10,this.option={tooltip:{trigger:"axis"},title:[{text:"Les produits achetés par le client",left:"25%",textAlign:"center",fontSize:12},{text:"les categories de produits achetés par le client",left:"75%",top:"20%",textAlign:"center",fontSize:8}],grid:[{top:50,width:"50%",bottom:"0%",left:10,containLabel:!0},{top:"50%",width:"50%",bottom:0,left:10,containLabel:!0}],xAxis:[{type:"value",max:e.all,splitLine:{show:!1}}],yAxis:[{type:"category",data:Object.keys(e.charts),axisLabel:{interval:0,fontSize:8,padding:[0,0,1,0]},splitLine:{show:!1}}],series:[{type:"bar",stack:"chart",z:3,label:{position:"right",show:!0},data:Object.keys(e.charts).map(function(a){return e.charts[a]})},{type:"pie",radius:[0,"30%"],center:["75%","50%"],tooltip:{trigger:"item"},data:Object.keys(r).map(function(a){return{name:a,value:r[a]}})}]},this.chart.setOption(this.option),window.addEventListener("resize",()=>{this.chart.resize()})},updateData:function(t,e,r){if(!this.option.series||!this.option.series[0]){console.error("Erreur : 'series' n'est pas correctement définie dans l'option.");return}const i=t.reduce((n,o)=>{const[p,y]=o.split(": ");return n[p]=parseInt(y,10),n},{});r==!0?(this.option.title[0].text="Les produits achetés par les clients",this.option.title[1].text="les categories de produits achetés"):(this.option.title[0].text="Les produits achetés par le client",this.option.title[1].text="les categories de produits achetés"),this.option.series[0].data=Object.keys(i).map(function(n){return i[n]}),this.option.yAxis[0].data=Object.keys(i);const a=e.reduce((n,o)=>{const[p,y]=o.split(": ");return n[p.replace(/'/g,"")]=parseInt(y,10),n},{});this.option.series[1].data=Object.keys(a).map(function(n){return{name:n,value:a[n]}}),this.chart.setOption(this.option)}};let f=function(t,e){let r=t;for(let i in e)r=r.replaceAll(new RegExp("{{"+i+"}}","g"),e[i]);return r};const T=await fetch("./src/ui/choix/template.html.inc"),A=await T.text();let M={render:function(t){let e="",r={id:"all",product_name:"all"},i=f(A,r);i=i.replaceAll("{{id_product}}",r.id),i=i.replace("{{name}}",r.product_name),e+=i;for(let a of t){let n=f(A,a);n=n.replaceAll("{{id_product}}",a.id),n=n.replace("{{name}}",a.product_name),e+=n}return e}};const $=await fetch("./src/ui/choixclient/template.html.inc"),S=await $.text();let j={render:function(t){let e="",r={id:"all",name:"all"},i=f(S,r);i=i.replaceAll("{{id_client}}",r.id),i=i.replace("{{name}}",r.name),e+=i;for(let a of t){let n=f(S,a);n=n.replaceAll("{{id_client}}",a.id),n=n.replace("{{name}}",a.first_name+" "+a.last_name),e+=n}return e}};const w={chart:null,option:null,init:function(){const t=document.getElementById("graphic-product");this.chart=echarts.init(t,null,{renderer:"canvas",useDirtyRect:!1});const e=document.createElement("canvas");e.width=e.height=10,this.option={tooltip:{trigger:"item",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},toolbox:{feature:{saveAsImage:{}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]}],yAxis:[{type:"value"}],series:[{type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:[120,132,101,134,90,230,210]}]},this.option&&typeof this.option=="object"&&this.chart.setOption(this.option),window.addEventListener("resize",()=>{this.chart.resize()})},updateData:function(t,e,r){if(!this.option){console.error("Erreur : 'option' n'est pas encore initialisé.");return}if(!this.option.series||!this.option.series[0]){console.error("Erreur : 'series' n'est pas correctement définie dans l'option.");return}if(r==!0){this.option.tooltip.trigger="item";const i=t.reduce((a,n)=>(a[n.product_name]||(a[n.product_name]=[]),a[n.product_name].push(n.total_quantity_sold),a),{});this.option.series=Object.keys(i).map(a=>({name:a,type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:i[a]}))}else this.option.tooltip.trigger="axis",t&&(this.option.series[0].data=t);e&&(this.option.xAxis[0].data=e),this.chart.setOption(this.option,!0),this.chart.resize()}},C=await fetch("./src/ui/graphicprod/template.html"),P=await C.text();let _={};_.render=function(){return P};const k=await fetch("./src/ui/graphicclient/template.html"),R=await k.text();let L={};L.render=function(){return R};let V="https://mmi.unilim.fr/~valin6/sae/SAE303/api/",c=async function(t){let e={method:"GET"};try{var r=await fetch(V+t,e)}catch(a){return console.error("Echec de la requête : "+a),!1}return r.status!=200?(console.error("Erreur de requête : "+r.status),!1):await r.json()},m={};m.fetch=async function(t){return await c("orderitems/"+t)};m.fetchAll=async function(){return await c("orderitems")};m.fetchiteration4=async function(){return await c("orderitems?stat=iteration4")};let d={};d.fetch=async function(t){return await c("products/"+t)};d.fetchAll=async function(){return await c("products")};d.fetchIteration7=async function(){return await c("products?stat=iteration7")};d.fetchIteration8=async function(){return await c("products?stat=iteration8")};d.fetchIteration8date=async function(){return await c("products?stat=iteration8-date")};let l={};l.fetch=async function(t){return await c("orders/"+t)};l.fetchIteration3=async function(){return await c("orders?stat=iteration3")};l.fetchIteration5=async function(){return await c("orders?stat=iteration5")};l.fetchIteration6Date=async function(){return await c("orders?stat=iteration6-date")};l.fetchIteration6=async function(){return await c("orders?stat=iteration6")};l.fetchIteration8=async function(t){return await c("orders?stat=iteration8&id="+t)};l.fetchIteration8none=async function(){return await c("orders?stat=iteration8none")};l.fetchIteration11=async function(){return await c("orders?stat=iteration11")};l.fetchAll=async function(){return await c("orders")};let u={};u.fetch=async function(t){return await c("clients/"+t)};u.fetchAll=async function(){return await c("clients")};u.fetchIteration9category=async function(t){return await c("clients?stat=iteration9category&id="+t)};u.fetchIteration9product=async function(t){return await c("clients?stat=iteration9product&id="+t)};u.fetchIteration9allcategory=async function(){return await c("clients?stat=iteration9allcategory")};u.fetchIteration9allproduct=async function(){return await c("clients?stat=iteration9allproduct")};u.fetchIteration9client=async function(){return await c("clients?stat=iteration9client")};const O={chart:null,option:null,init:function(){const t=document.getElementById("graphic-map");this.chart=echarts.init(t,null,{renderer:"canvas",useDirtyRect:!1}),this.option={title:{text:"Quantité des articles expédiés dans chaque pays par mois",left:"center",top:"5%"},tooltip:{position:"top"},grid:{height:"65%",top:"20%"},xAxis:{type:"category",data:["12a","1a","2a","3a","4a","5a","6a","7a","8a","9a","10a","11a","12p","1p","2p","3p","4p","5p","6p","7p","8p","9p","10p","11p"],splitArea:{show:!0}},yAxis:{type:"category",data:["Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday"],splitArea:{show:!0}},visualMap:{color:["#732424","#ff0000","#e0ffff"],calculable:!0,orient:"horizontal",left:"center",bottom:"2%"},series:[{name:"Punch Card",type:"heatmap",data:[[0,0,5],[0,1,1],[0,2,0],[0,3,0],[0,4,0],[0,5,0],[0,6,0],[0,7,0],[0,8,0],[0,9,0],[0,10,0],[0,11,2],[0,12,4],[0,13,1],[0,14,1],[0,15,3],[0,16,4],[0,17,6],[0,18,4],[0,19,4],[0,20,3],[0,21,3],[0,22,2],[0,23,5],[1,0,7],[1,1,0],[1,2,0],[1,3,0],[1,4,0],[1,5,0],[1,6,0],[1,7,0],[1,8,0],[1,9,0],[1,10,5],[1,11,2],[1,12,2],[1,13,6],[1,14,9],[1,15,11],[1,16,6],[1,17,7],[1,18,8],[1,19,12],[1,20,5],[1,21,5],[1,22,7],[1,23,2],[2,0,1],[2,1,1],[2,2,0],[2,3,0],[2,4,0],[2,5,0],[2,6,0],[2,7,0],[2,8,0],[2,9,0],[2,10,3],[2,11,2],[2,12,1],[2,13,9],[2,14,8],[2,15,10],[2,16,6],[2,17,5],[2,18,5],[2,19,5],[2,20,7],[2,21,4],[2,22,2],[2,23,4],[3,0,7],[3,1,3],[3,2,0],[3,3,0],[3,4,0],[3,5,0],[3,6,0],[3,7,0],[3,8,1],[3,9,0],[3,10,5],[3,11,4],[3,12,7],[3,13,14],[3,14,13],[3,15,12],[3,16,9],[3,17,5],[3,18,5],[3,19,10],[3,20,6],[3,21,4],[3,22,4],[3,23,1],[4,0,1],[4,1,3],[4,2,0],[4,3,0],[4,4,0],[4,5,1],[4,6,0],[4,7,0],[4,8,0],[4,9,2],[4,10,4],[4,11,4],[4,12,2],[4,13,4],[4,14,4],[4,15,14],[4,16,12],[4,17,1],[4,18,8],[4,19,5],[4,20,3],[4,21,7],[4,22,3],[4,23,0],[5,0,2],[5,1,1],[5,2,0],[5,3,3],[5,4,0],[5,5,0],[5,6,0],[5,7,0],[5,8,2],[5,9,0],[5,10,4],[5,11,1],[5,12,5],[5,13,10],[5,14,5],[5,15,7],[5,16,11],[5,17,6],[5,18,0],[5,19,5],[5,20,3],[5,21,4],[5,22,2],[5,23,0],[6,0,1],[6,1,0],[6,2,0],[6,3,0],[6,4,0],[6,5,0],[6,6,0],[6,7,0],[6,8,0],[6,9,0],[6,10,1],[6,11,0],[6,12,2],[6,13,1],[6,14,3],[6,15,4],[6,16,0],[6,17,0],[6,18,0],[6,19,0],[6,20,1],[6,21,2],[6,22,2],[6,23,6]].map(function(e){return[e[1],e[0],e[2]||"-"]}),label:{show:!0},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},this.option&&typeof this.option=="object"&&this.chart.setOption(this.option),window.addEventListener("resize",()=>{this.chart.resize()})},updateData:function(t,e,r){if(!this.option){console.error("Erreur : 'option' n'est pas encore initialisé.");return}this.option.xAxis.data=t,this.option.yAxis.data=e,this.option.series[0].data=r,this.chart.setOption(this.option,!0),this.chart.resize()}};let h={};h.init=async function(){s.init()};let s={header:document.querySelector("#header"),main:document.querySelector("#main"),graphic:document.querySelector("#graphic-barre"),courbe:document.querySelector("#graphic-courbe"),barrecourbe:document.querySelector("#graphic-barrecourbe"),demicercle:document.querySelector("#graphic-demicercle"),choix:document.querySelector("#choix"),graphicprod:document.querySelector("#graphic-produits"),graphicclients:document.querySelector("#graphic-clients"),graphicmap:document.querySelector("#graphic-maps")};s.init=function(){s.renderHeader(),s.renderMain(),s.renderGraphic(),s.renderCourbe(),s.renderBarreCourbe(),s.renderDemicercle(),s.rendermap(),document.querySelector("#graphic-produits")&&(s.rendergraphprod(),document.querySelector("#choix")&&(s.renderChoix(),s.renderproduct("all"),document.querySelector("#choix").addEventListener("click",h.handler_clickOnproduct))),document.querySelector("#graphic-clients")&&(s.rendergraphclient(),document.querySelector("#choixclient")&&(s.renderChoixclient(),s.renderclient("all"),document.querySelector("#choixclient").addEventListener("click",h.handler_clickOnclient)))};s.renderHeader=function(){s.header.innerHTML=D.render()};s.rendergraphprod=function(){s.graphicprod.innerHTML=_.render()};s.rendergraphclient=function(){s.graphicclients.innerHTML=L.render()};s.renderMain=async function(){let t=await l.fetchIteration3();x.init();let e=t.map(r=>({value:r.montant,name:r.order_status}));x.updateData(e)};s.renderGraphic=async function(){b.init();let t=await m.fetchiteration4(),e=t.map(i=>i.product_name),r=t.map(i=>i.total_sales);b.updateData(r,e)};s.renderCourbe=async function(){v.init();let t=await l.fetchIteration5(),e=t.map(i=>i.month),r=t.map(i=>i.monthly_sales);v.updateData(r,e)};s.renderBarreCourbe=async function(){I.init();let t=await l.fetchIteration6(),e=await l.fetchIteration6Date(),r={};t.forEach(o=>{r[o.product_category]||(r[o.product_category]=[]),r[o.product_category].push(o.total_sales)});let i=Object.values(r),a=Object.keys(r),n=e.map(o=>o.month);I.updateData(i,n,a)};s.renderDemicercle=async function(){let t=await d.fetchIteration7();E.init();let e=t.map(r=>({value:r.stock,name:r.product_name}));E.updateData(e)};s.renderChoix=async function(){let t=await d.fetchIteration8(),e=M.render(t);document.querySelector("#choix").innerHTML=e};s.renderproduct=async function(t){if(w.init(),t==="all"){let e=await l.fetchIteration8none(),r=await d.fetchIteration8date(),i=!0,a=r.map(n=>n.month);w.updateData(e,a,i)}else{let e=await l.fetchIteration8(t),r=await d.fetchIteration8date(),i=e.map(o=>o.total_quantity_sold),a=r.map(o=>o.month);w.updateData(i,a,!1)}};h.handler_clickOnproduct=async function(t){try{let e=t.target.options[t.target.selectedIndex].value;s.renderproduct(e)}catch{console.error("No value attribute")}};s.renderChoixclient=async function(){let t=await u.fetchIteration9client(),e=j.render(t);document.querySelector("#choixclient").innerHTML=e};s.renderclient=async function(t){if(g.init(),t==="all"){let e=await u.fetchIteration9allcategory(),i=(await u.fetchIteration9allproduct()).map(o=>`${o.Product}: ${o.Total_Quantity}`),a=e.map(o=>`'${o.category}': ${o.total_quantity}`);g.updateData(i,a,!0)}else{let e=await u.fetchIteration9product(t),r=await u.fetchIteration9category(t),i=e.map(o=>`${o.Product}: ${o.Total_Quantity}`),a=r.map(o=>`'${o.category}': ${o.total_quantity}`);g.updateData(i,a,!1)}};h.handler_clickOnclient=async function(t){try{let e=t.target.options[t.target.selectedIndex].value;s.renderclient(e)}catch{console.error("No value attribute")}};s.rendermap=async function(){O.init(),console.log("Map");let t=await l.fetchIteration11(),e=[...new Set(t.map(a=>a.country))],r=[...new Set(t.map(a=>a.month_year))],i=[];e.forEach(a=>{r.forEach(n=>{let o=t.find(p=>p.country===a&&p.month_year===n);i.push([r.indexOf(n),e.indexOf(a),o?o.total_quantity:0])})}),console.log(i),O.updateData(r,e,i)};h.init();
